<!DOCTYPE html>
<!-- INJECTS IE CLASSES ONTO HTML TAG -->
<!--[if IE 8 ]>    <html class="IE8"> <![endif]-->
<!--[if IE 9 ]>    <html class="IE9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class=""> <!--<![endif]-->
	<head>
		<title>Enigma Widget Creator</title>
		<meta charset="utf-8" />

		<!-- STYLESHEETS -->
		<link rel="stylesheet" type="text/css" href="creator.css">
		<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700' rel='stylesheet' type='text/css'>

		<!-- REQUIRED MATERIA JAVASCRIPT -->
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="/js/materia.creatorcore.js"></script>

		<!-- YOUR PREREQUISITES -->
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.0rc3/angular.min.js"></script>

		<!-- MAIN CREATOR SCRIPT -->
		<script src="creator.js"></script>
	</head>
	<body ng-cloak ng-controller='enigmaCreatorCtrl'>
		<div id='modal'></div>
		<div id='header'>
			<div class='logo'></div>
			<h1 id='title' ng-bind='title'></h1>
			<div class='center'>{{numQuestions()}} Questions</div>
			<div class='right'>
				Randomize Answer Order
				<input type='checkbox' id='randomize' ng-model='qset.options.randomize'/>
				<label for='randomize' class='checktoggle'></label>
			</div>
		</div>
		<div id='board'>
			<div class='category' ng-repeat='category in qset.items'>
				<div class='label' style='opacity:{{ (category.name || category.isEditing) ? 1 : 0.1 }}'>
					<textarea placeholder='New Category' ng-model='category.name' id='category_{{$index}}' ng-focus='category.isEditing=true' ng-blur='category.isEditing=false'></textarea>
				</div>
				<button ng-show='!category.name && !category.isEditing' class='add'></button>
				<div ng-show='!category.name && !category.isEditing' class='newcat' ng-click='newCategory({{$index}}, category)'>New Category</div>
				<div class='questionholder' ng-repeat='question in category.items' ng-click='editQuestion(category,question,{{$index}})'>
					<div class='question' style='opacity:{{ question.questions[0].text ? 1 : 0.1 }}'></div>
					<button ng-show='!question.questions[0].text && category.name && ($index == 0 || category.items[$index-1].questions[0].text)' class='add'></button>
				</div>
			</div>
			<div id='question_editor' style='top: {{(curCategory.index+1) * 125}}px' ng-show='curQuestion'>
				<div class='title'>Question {{curQuestion.index+1}} in "{{curCategory.name}}"</div>

				<textarea ng-model='curQuestion.questions[0].text' placeholder='Enter your question here' id='question_text' autofocus></textarea>

				<div class='questions'>
					<div ng-repeat='answer in curQuestion.answers'>
						<textarea ng-model='answer.text' placeholder='Enter an answer choice'></textarea>
						<textarea ng-model='answer.options.feedback' placeholder='Enter optional feedback'></textarea>

						<div class='controls'>
							<div ng-show='!answer.options.custom'>
								<input type='checkbox' id='qtoggle{{$index}}' ng-model='answer.options.correct'/>
								<label for='qtoggle{{$index}}' class='checktoggle correctness'><span></span></label>
								<a href='javascript:;' ng-click='answer.options.custom = true'>Set percentage</a>
							</div>
							<div class='text' ng-show='answer.options.custom'>
								<input type='text' ng-model='answer.value' ng-blur=''>%
							</div>
						</div>
						<button class='delete' ng-click='deleteAnswer($index)'></button>
					</div>
					<a href='javascript:;' ng-click='addAnswer()'>+ Add another answer choice</a>
				</div>
				<div class='controls'>
					<a href='javascript:;' ng-click='deleteQuestion(curQuestion.index)'>Delete</a>
					<input type='button' value='Close' ng-click='editComplete()'>
				</div>
			</div>
		</div>
		<div id='backgroundcover'></div>
		<div class='box intro'>
			<img src='assets/creator_example.png'>
			<h1>Enigma</h1>
			<p>Create a gameboard of multiple choice questions</p>
			<p>Questions are organized by categories.</p>
			<p>Each question is worth the same amount.</p>
			<hr>
			<b>Start by giving your Enigma widget a title</b><br>
			<input type='text' placeholder='My enigma widget' autofocus='1'>
			<input type='button' value='Get Started'>
		</div>

		<!-- INITIALIZE -->
		<script type="text/javascript">
			angular.bootstrap(document, ['enigmaCreator']);
			Materia.CreatorCore.start(Enigma.Creator);
		</script>

	</body>
</html>
